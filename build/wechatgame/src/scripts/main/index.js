window.__require=function e(t,o,n){function r(a,c){if(!o[a]){if(!t[a]){var u=a.split("/");if(u=u[u.length-1],!t[u]){var l="function"==typeof __require&&__require;if(!c&&l)return l(u,!0);if(i)return i(u,!0);throw new Error("Cannot find module '"+a+"'")}a=u}var s=o[a]={exports:{}};t[a][0].call(s.exports,function(e){return r(t[a][1][e]||e)},s,s.exports,e,t,o,n)}return o[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<n.length;a++)r(n[a]);return r}({AudioMgr:[function(e,t,o){"use strict";var n;cc._RF.push(t,"b545bFTIb1JV5LuLuiz55fk","AudioMgr"),Object.defineProperty(o,"__esModule",{value:!0}),o.audioMgr=o.SHAKE_TYPE=o.SoundType=o.MusicType=void 0,o.MusicType||(o.MusicType={}),function(e){e.MOVE_COIN="moveCoin",e.PRODUCE_COIN="produceCoin",e.MERGE_COIN="mergeCoin",e.ERROR="error",e.ZYX_START="sound_start",e.ZYX_END="sound_endding",e.ZYX_DROP="sound_drop",e.ZYX_MUSIC_MAIN="music_main1",e.ZYX_MUSIC_GAME="music_game"}(o.SoundType||(o.SoundType={})),function(e){e.HEAVY="heavy",e.MEDIUM="medium",e.LIGHT="light",e.SUPER_HEAVY=""}(n=o.SHAKE_TYPE||(o.SHAKE_TYPE={}));var r=function(){function e(){this.soundClipCache={},this.audioIds={},this.musicVolume=null,this.soundVolume=null,this.curBgMusicUrl=null,this.canPlayMusic=!0,this.canPlaySound=!0,this.musicId=-1}return e.prototype.init=function(){cc.log("audioMgr init"),this.curBgMusicUrl=null,this.musicVolume=.2,this.soundVolume=1,this.canPlayMusic=!0,this.canPlaySound=!0},e.prototype.playBGM=function(e){var t=this;this.curBgMusicUrl&&this.curBgMusicUrl==e||(this.curBgMusicUrl=e,this.canPlayMusic&&(this.stopBGM(),cc.resources.load("sounds/"+e,function(o,n){t.curBgMusicUrl==e?(cc.audioEngine.stopAll(),t.musicId=cc.audioEngine.play(n,!0,t.musicVolume)):console.log("\u64ad\u653e\u80cc\u666f\u97f3\u4e50\u5931\u8d25:",o)})))},e.prototype.stopBGM=function(){cc.audioEngine.stop(this.musicId)},e.prototype.playSound=function(e,t,o,n,r,i){var a=this;if(void 0===t&&(t=this.soundVolume),void 0===o&&(o=".mp3"),void 0===n&&(n=!1),void 0===r&&(r=!1),this.canPlaySound){var c="sounds/"+e;if(this.soundClipCache[""+c])cc.audioEngine.play(this.soundClipCache[""+c],n,t),i&&i();else if(r){if(!c.startsWith("https://"))return void(i&&i());cc.assetManager.loadRemote(c,{ext:o},function(e,o){if(e)console.error(e);else{var r=cc.audioEngine.play(o,n,t);a.audioIds[c]=r}i&&i()})}else cc.resources.load(c,function(e,o){if(e)console.error(e);else{var r=cc.audioEngine.play(o,n,t);a.soundClipCache[""+c]=o,a.audioIds[c]=r}i&&i()})}else i&&i()},e.prototype.stopSoundByUrl=function(e){var t=this.audioIds[e];null!=t&&cc.audioEngine.stop(t)},e.prototype.stopSound=function(e){console.log("audioId",e),null!=e&&cc.audioEngine.stop(e)},e.prototype.pauseBGM=function(){this.musicId>=0&&cc.audioEngine.pause(this.musicId)},e.prototype.resumeBGM=function(){this.musicId>=0&&cc.audioEngine.resume(this.musicId)},e.prototype.uncache=function(e){var t=cc.url.raw(e);cc.audioEngine.uncache(t),this.soundClipCache[""+e]=void 0},e.prototype.uncacheAll=function(){cc.audioEngine.uncacheAll(),this.soundClipCache={}},e.prototype.pauseAll=function(){console.log("Pause All Sound"),cc.audioEngine.pauseAll()},e.prototype.resumeAll=function(){console.log("Resum All Sound"),cc.audioEngine.resumeAll()},e.prototype.stopAll=function(){cc.audioEngine.stopAll()},e.prototype.clean=function(){this.stopAll(),this.uncacheAll(),this.curBgMusicUrl="",this.musicId=-1},e.prototype.shake=function(e){window.wx&&(e===n.SUPER_HEAVY?wx.vibrateLong():wx.vibrateShort({type:e}))},e.Instance=new e,e}();o.default=r,o.audioMgr=r.Instance,cc._RF.pop()},{}],Coin:[function(e,t,o){"use strict";cc._RF.push(t,"6cba59FrPtA0YaVzatN4FVJ","Coin");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,c=a.ccclass,u=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ulblNum=null,t.uImgBg=null,t}return r(t,e),t.prototype.onLoad=function(){this.ulblNum.string="-"},t.prototype.init=function(e,t,o){var n=this,r="images/coin/"+t;cc.resources.load(r,cc.SpriteFrame,function(e,t){e?console.error("url:",r,"/err:"):(n.uImgBg.spriteFrame=t,o&&o())}),this.ulblNum.string=""+t},t.prototype.start=function(){},i([u(cc.Label)],t.prototype,"ulblNum",void 0),i([u(cc.Sprite)],t.prototype,"uImgBg",void 0),i([c],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],DataModule:[function(e,t,o){"use strict";cc._RF.push(t,"a9783XxZiJAGobx47+4NsqL","DataModule"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.mData=null}return e.prototype.parseData=function(e){this.mData=e},e}();o.default=n,cc._RF.pop()},{}],Define:[function(e,t,o){"use strict";cc._RF.push(t,"b316ef97uJJrLtjj1+6n+lc","Define"),Object.defineProperty(o,"__esModule",{value:!0}),o.EventType=void 0,function(e){e.MOVE_COIN="move_coin",e.MOVE_END="move_end",e.CHECK_MERGE="check_merge",e.MERGE_COIN="merge_coin",e.MERGE_END="merge_end",e.MOVE_CHECK_FAIL="move_check_fail",e.CANCEL_SELECT="CANCEL_SELECT",e.ZYX_CHECK_MERGE="zyx_check_merge",e.ZYX_RESET_GAME="zyx_reset_game"}(o.EventType||(o.EventType={})),cc._RF.pop()},{}],EventManager:[function(e,t,o){"use strict";cc._RF.push(t,"ea7fbBwaBVK96i8sl/y0ydr","EventManager");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.eventManager=o.GameEvent=o.EventManager=void 0;var i=function(e){function t(){return e.call(this)||this}return r(t,e),t.prototype.dispatch=function(e,t){this.dispatchEvent(new a(e,t))},t.Instance=new t,t}(cc.EventTarget);o.EventManager=i;var a=function(e){function t(t,o){void 0===o&&(o=null);var n=e.call(this,t,!0)||this;return n.data=null,n.type="",n.type=t,n.data=o,n}return r(t,e),t}(cc.Event.EventCustom);o.GameEvent=a,o.eventManager=i.Instance,cc._RF.pop()},{}],GameModule:[function(e,t,o){"use strict";cc._RF.push(t,"64566mmcFVMhZE7goFc3ntd","GameModule");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.gameModule=void 0;var i=e("../manager/Define"),a=e("../util/EventManager"),c=e("../util/NewUtils"),u=function(e){function t(){var t=e.call(this)||this;return t.slotData=[],t.curSelectSlotIdx=-1,t.curSelectCoinIdxs=[],t.moveLock=!1,t.mergeLock=0,t.produceLock=0,t.star=0,t.extraChance=0,t}return r(t,e),t.prototype.parseData=function(t){e.prototype.parseData.call(this,t),this.slotData=t.slotData,this.star=t.star},Object.defineProperty(t.prototype,"canOperate",{get:function(){return this.moveLock?(console.log("\u6b63\u5728\u8fdb\u884c\u79fb\u52a8\u64cd\u4f5c"),!1):0!==this.mergeLock?(console.log("\u6b63\u5728\u8fdb\u884c\u5408\u6210\u64cd\u4f5c"),!1):0===this.produceLock||(console.log("\u6b63\u5728\u53d1\u653e\u7b79\u7801\u64cd\u4f5c"),!1)},enumerable:!1,configurable:!0}),t.prototype.getFirstVaildNumBySlotIdx=function(e){for(var t=this.slotData[e],o=-1,n=-1,r=10,i=9;i>=0;i--)if(0!==t[i]){o=t[i],n=i,r=9-i;break}return{vaildNum:o,vaildIdx:n,vaildSpace:r}},t.prototype.getCurSelectSlotInfo=function(){if(-1===this.curSelectSlotIdx)return null;var e=this.curSelectCoinIdxs.length,t=this.slotData[this.curSelectSlotIdx][this.curSelectCoinIdxs[0]];return{slotIdx:this.curSelectSlotIdx,cnt:e,num:t}},t.prototype.resetSelectStatus=function(){o.gameModule.curSelectSlotIdx=-1,o.gameModule.curSelectCoinIdxs=[]},t.prototype.tidySlotData=function(e){for(var t=0;t<e.srcIdxArr.length;t++)this.slotData[this.curSelectSlotIdx][e.srcIdxArr[t]]=0,this.slotData[e.tarSlotIdx][e.tarIdxArr[t]]=e.numType;a.eventManager.dispatch(i.EventType.MOVE_END,e),this.resetSelectStatus(),a.eventManager.dispatch(i.EventType.CHECK_MERGE)},t.prototype.checkCanMerge=function(){for(var e=[],t=0;t<8;t++)this.checkCanMergeBySlot(t)&&e.push(t);return e},t.prototype.checkCanMergeBySlot=function(e){for(var t=this.slotData[e],o=0;o<10;o++){if(0===t[o])return!1;if(0!==o&&t[o]!==t[o-1])return!1}return!0},t.prototype.getMaxValue=function(){for(var e=0,t=0;t<this.slotData.length;t++)for(var o=0;o<this.slotData[t].length;o++)this.slotData[t][o]>e&&(e=this.slotData[t][o]);return e},t.prototype.getMinValue=function(){for(var e=-1,t=0;t<this.slotData.length;t++)for(var o=0;o<this.slotData[t].length;o++)-1===e&&0!==this.slotData[t][o]&&(e=this.slotData[t][o]),this.slotData[t][o]<e&&0!==this.slotData[t][o]&&(e=this.slotData[t][o]);return e},t.prototype.getSpaceBySlot=function(e){if(this.slotData[e]){for(var t=0;t<this.slotData[e].length;t++)if(0===this.slotData[e][t])return 10-t;return 0}},t.prototype.getSpace=function(){for(var e=0,t=0;t<8;t++)e+=this.getSpaceBySlot(t);return e},t.prototype.produceNewCoinData=function(){var e=this.getMaxValue(),t=this.getSpace();if(e>=15)console.warn("\u5f53\u524d\u5df2\u5408\u621015");else{if(0!==t)return e<5?this.produceStrategyOne(e,t):e<10?this.produceStrategyTwo(e,t):e<14?this.produceStrategyThree(e,t):e<15?this.produceStrategyFour(e,t):void 0;console.warn("\u6ca1\u6709\u5269\u4f59\u7a7a\u95f4\uff0c\u65e0\u6cd5\u751f\u6210\u65b0\u6570\u5b57")}},t.prototype.produceStrategyOne=function(e,t){console.log("\u7b56\u75651:<5");var o=Math.min(1,this.getMinValue()),n=Math.floor(Math.min(25,.6*t));0===n&&(n=1);var r=e-1>0?e-1:1,i=n>=4?4:n;i=Math.min(i,r-o+1);for(var a=c.default.randomIntArrFromSection(i,o,r),u=c.default.randomIntArrFromArr(n,a),l=[],s=0;s<8;s++){var d=this.getSpaceBySlot(s);l.push(d)}var p=[[],[],[],[],[],[],[],[]];do{var f=c.default.randomIntInclusive(0,7);0!==l[f]&&(p[f].push(u.shift()),l[f]--)}while(u.length>0);return p},t.prototype.produceStrategyTwo=function(e,t){console.log("\u7b56\u75652:5<=x<10");var o=Math.min(3,this.getMinValue()),n=Math.floor(Math.min(22,.6*t));0===n&&(n=1);var r=Math.min(e-1,7),i=n>=3?3:n;i=Math.min(i,r-o+1);for(var a=c.default.randomIntArrFromSection(i,o,r),u=c.default.randomIntArrFromArr(n,a),l=[],s=0;s<8;s++){var d=this.getSpaceBySlot(s);l.push(d)}var p=[[],[],[],[],[],[],[],[]];do{var f=c.default.randomIntInclusive(0,7);0!==l[f]&&(p[f].push(u.shift()),l[f]--)}while(u.length>0);return p},t.prototype.produceStrategyThree=function(e,t){console.log("\u7b56\u75653: 10<x<14");var o=Math.min(8,this.getMinValue()),n=Math.floor(Math.min(20,.6*t));0===n&&(n=1);var r=Math.min(e-1,11),i=n>=3?3:n;i=Math.min(i,r-o+1);for(var a=c.default.randomIntArrFromSection(i,o,r),u=c.default.randomIntArrFromArr(n,a),l=[],s=0;s<8;s++){var d=this.getSpaceBySlot(s);l.push(d)}var p=[[],[],[],[],[],[],[],[]];do{var f=c.default.randomIntInclusive(0,7);0!==l[f]&&(p[f].push(u.shift()),l[f]--)}while(u.length>0);return p},t.prototype.produceStrategyFour=function(e,t){console.log("\u7b56\u75651:<15");var o=Math.min(11,this.getMinValue()),n=Math.floor(Math.min(25,.8*t));0===n&&(n=1);for(var r=Math.min(e-1,11),i=n>=3?3:n,a=c.default.randomIntArrFromSection(i,o,r),u=c.default.randomIntArrFromArr(n,a),l=[],s=0;s<8;s++){var d=this.getSpaceBySlot(s);l.push(d)}var p=[[],[],[],[],[],[],[],[]];do{var f=c.default.randomIntInclusive(0,7);0!==l[f]&&(p[f].push(u.shift()),l[f]--)}while(u.length>0);return p},t.prototype.mergeProduceData=function(e){for(var t=0;t<8;t++)for(var o=c.default.deepClone(e[t]),n=0;n<10;n++)if(0===this.slotData[t][n]&&o.length>0){var r=o.shift();this.slotData[t][n]=r}},t.prototype.tidyData=function(){for(var e={},t=0;t<this.slotData.length;t++)for(var o=0;o<10;o++)0!==this.slotData[t][o]&&(e[""+this.slotData[t][o]]?e[""+this.slotData[t][o]]+=1:e[""+this.slotData[t][o]]=1);console.log("dataMap:",e);var n=[];for(var r in e){e[r]>10&&(e[r]=10);var i=[];for(t=0;t<10;t++)t<=e[r]-1?i.push(Number(r)):i.push(0);n.push(i)}if(n.sort(function(e,t){return t[0]-e[0]}),n.length>8)this.slotData=n.slice(0,7);else{for(t=0;t<8;t++)n.length<=t&&n.push([0,0,0,0,0,0,0,0,0,0]);this.slotData=n}console.log("\u6574\u7406\u540e\u7684slotData:",n,this.slotData)},t}(e("./DataModule").default);o.default=u,o.gameModule=new u,cc._RF.pop()},{"../manager/Define":"Define","../util/EventManager":"EventManager","../util/NewUtils":"NewUtils","./DataModule":"DataModule"}],Game:[function(e,t,o){"use strict";cc._RF.push(t,"650a2ldzTZM6Joa8EAO498E","Game");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},a=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(r,i){function a(e){try{u(n.next(e))}catch(t){i(t)}}function c(e){try{u(n.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}u((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(e){return function(t){return u([e,t])}}function u(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(c){i=[6,c],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var u=e("../dataModule/GameModule"),l=e("../manager/AudioMgr"),s=e("../manager/Define"),d=e("../manager/Uimanager"),p=e("../util/EventManager"),f=e("./GoodsList"),h=e("./MergeProgress"),y=e("./Slot"),g=cc._decorator,m=g.ccclass,v=g.property,M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uBoxSlot=null,t.uBtnProduce=null,t.uBtnTidyUp=null,t.uBtnMerge=null,t.uBar=null,t.uPanel=null,t.ulblStar=null,t.slots=[],t}return r(t,e),t.prototype.onLoad=function(){return a(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return this.uBtnMerge.on(cc.Node.EventType.TOUCH_END,this.onMerge,this),this.uBtnProduce.on(cc.Node.EventType.TOUCH_END,this.onProduce,this),this.uBtnTidyUp.on(cc.Node.EventType.TOUCH_END,this.onTidy,this),p.eventManager.on(s.EventType.CHECK_MERGE,this.updateBtn,this),p.eventManager.on(s.EventType.MERGE_END,this.updateProgress,this),[4,this.addSlot()];case 1:return e.sent(),this.formatSlotData(),this.updateBtn(),this.updateProgress(),this.uPanel.getComponent(f.default).initGoods(),this.ulblStar.string="x "+u.gameModule.star,[2]}})})},t.prototype.start=function(){},t.prototype.addSlot=function(){return a(this,void 0,void 0,function(){var e,t,o,n,r,i,a,u,l;return c(this,function(c){switch(c.label){case 0:t=212,o=(608-4*(e=116))/3,n=this.uBoxSlot.height-2*t+t,r=0,c.label=1;case 1:return r<8?(i=Math.floor(r/4),a=r%4,[4,d.uimanager.loadPrefab("prefab/merge/slot")]):[3,4];case 2:u=c.sent(),l=cc.instantiate(u),this.uBoxSlot.addChild(l),l.x=a*e+o*a,l.y=-t-n*i,this.slots.push(l),c.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},t.prototype.formatSlotData=function(){for(var e=0;e<8;e++)this.slots[e].getComponent(y.default).formatData(e,u.gameModule.slotData[e]);p.eventManager.dispatch(s.EventType.CHECK_MERGE)},t.prototype.updateBtn=function(){var e=u.gameModule.checkCanMerge();this.uBtnMerge.active=e.length>0},t.prototype.updateProgress=function(){this.uBar.getComponent(h.default).updateProress()},t.prototype.onMerge=function(){u.gameModule.canOperate&&(p.eventManager.dispatch(s.EventType.MERGE_COIN),this.uBtnMerge.active=!1)},t.prototype.onProduce=function(){if(u.gameModule.canOperate){l.audioMgr.playSound(l.SoundType.PRODUCE_COIN);for(var e=[],t=0;t<8;t++)for(var o=0;o<10;o++){if(0===u.gameModule.slotData[t][o]){e.push(o);break}9===o&&e.push(9)}var n=u.gameModule.produceNewCoinData();for(t=0;t<this.slots.length;t++)this.slots[t].getComponent(y.default).produce(n[t],this.node.convertToWorldSpaceAR(this.uBtnProduce.getPosition()),e[t]);u.gameModule.mergeProduceData(n),p.eventManager.dispatch(s.EventType.CHECK_MERGE)}},t.prototype.onTidy=function(){u.gameModule.canOperate&&(u.gameModule.extraChance<2&&wx.shareAppMessage({title:"\u6211\u89c9\u5f97\u4f60\u4e0d\u884c"}),u.gameModule.extraChance)},t.prototype.doTidy=function(){-1!==u.gameModule.curSelectSlotIdx&&p.eventManager.dispatch(s.EventType.CANCEL_SELECT),u.gameModule.tidyData(),this.formatSlotData()},i([v(cc.Node)],t.prototype,"uBoxSlot",void 0),i([v(cc.Node)],t.prototype,"uBtnProduce",void 0),i([v(cc.Node)],t.prototype,"uBtnTidyUp",void 0),i([v(cc.Node)],t.prototype,"uBtnMerge",void 0),i([v(cc.Node)],t.prototype,"uBar",void 0),i([v(cc.Node)],t.prototype,"uPanel",void 0),i([v(cc.Label)],t.prototype,"ulblStar",void 0),i([m],t)}(cc.Component);o.default=M,cc._RF.pop()},{"../dataModule/GameModule":"GameModule","../manager/AudioMgr":"AudioMgr","../manager/Define":"Define","../manager/Uimanager":"Uimanager","../util/EventManager":"EventManager","./GoodsList":"GoodsList","./MergeProgress":"MergeProgress","./Slot":"Slot"}],GoodsCom:[function(e,t,o){"use strict";cc._RF.push(t,"b87589+qj5GgbqZ/w8AZBbf","GoodsCom");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../dataModule/GoodsModule"),c=cc._decorator,u=c.ccclass,l=c.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.uImgGoods=null,t.ulblName=null,t.ulblStar=null,t.ulblInventory=null,t.uBtnGet=null,t.idx=-1,t}return r(t,e),Object.defineProperty(t.prototype,"goodsData",{get:function(){return a.goodsModule.goods[this.idx]},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onSelect,this),this.uBtnGet.on(cc.Node.EventType.TOUCH_END,this.onGet,this)},t.prototype.init=function(e){this.idx=e,this.formatGoodsInfo()},t.prototype.formatGoodsInfo=function(){var e=this,t=this.goodsData,o="images/goods/img_goods_"+t.id;cc.resources.load(o,cc.SpriteFrame,function(t,n){t?console.error("url:",o,"/err:"):e.uImgGoods.spriteFrame=n}),this.ulblName.string=t.name,this.ulblStar.string="x "+t.star},t.prototype.onSelect=function(){console.log("[DEBUG] \u663e\u793a\u5546\u54c1\u8be6\u60c5",this.goodsData)},t.prototype.onGet=function(){console.log("[DEBUG] \u5151\u6362\u5546\u54c1"+this.goodsData.name)},i([l(cc.Label)],t.prototype,"label",void 0),i([l(cc.Sprite)],t.prototype,"uImgGoods",void 0),i([l(cc.Label)],t.prototype,"ulblName",void 0),i([l(cc.Label)],t.prototype,"ulblStar",void 0),i([l(cc.Label)],t.prototype,"ulblInventory",void 0),i([l(cc.Node)],t.prototype,"uBtnGet",void 0),i([u],t)}(cc.Component);o.default=s,cc._RF.pop()},{"../dataModule/GoodsModule":"GoodsModule"}],GoodsList:[function(e,t,o){"use strict";cc._RF.push(t,"c429fRntiVHaLkAc6vP2F5Q","GoodsList");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},a=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(r,i){function a(e){try{u(n.next(e))}catch(t){i(t)}}function c(e){try{u(n.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}u((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(e){return function(t){return u([e,t])}}function u(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(c){i=[6,c],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var u=e("../dataModule/GoodsModule"),l=e("../manager/Uimanager"),s=e("./GoodsCom"),d=cc._decorator,p=d.ccclass,f=d.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.uPanel=null,t}return r(t,e),t.prototype.onLoad=function(){},t.prototype.initGoods=function(){return a(this,void 0,void 0,function(){var e,t;return c(this,function(o){switch(o.label){case 0:this.uPanel.content.removeAllChildren(),e=0,o.label=1;case 1:return e<u.goodsModule.goods.length?[4,this.produceGoods()]:[3,4];case 2:(t=o.sent()).getComponent(s.default).init(e),this.uPanel.content.addChild(t),t.x=e*t.width+t.width/2,this.uPanel.content.width=(e+1)*t.width,o.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},t.prototype.produceGoods=function(){return a(this,void 0,Promise,function(){var e;return c(this,function(t){switch(t.label){case 0:return[4,l.uimanager.loadPrefab("prefab/merge/goodsCom")];case 1:return e=t.sent(),[2,cc.instantiate(e)]}})})},i([f(cc.Label)],t.prototype,"label",void 0),i([f(cc.ScrollView)],t.prototype,"uPanel",void 0),i([p],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../dataModule/GoodsModule":"GoodsModule","../manager/Uimanager":"Uimanager","./GoodsCom":"GoodsCom"}],GoodsModule:[function(e,t,o){"use strict";cc._RF.push(t,"beefbM59wVK1oMpVwTVCzYm","GoodsModule");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.goodsModule=void 0;var i=function(e){function t(){var t=e.call(this)||this;return t.goods=[],t}return r(t,e),t.prototype.parseData=function(t){e.prototype.parseData.call(this,t),this.goods=t.goods},t}(e("./DataModule").default);o.default=i,o.goodsModule=new i,cc._RF.pop()},{"./DataModule":"DataModule"}],MergeProgress:[function(e,t,o){"use strict";cc._RF.push(t,"77cddiCwBxKFLf9oKyUt+gA","MergeProgress");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../dataModule/GameModule"),c=cc._decorator,u=c.ccclass,l=c.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ulblTar=null,t.uImgBar=null,t}return r(t,e),t.prototype.onLoad=function(){this.uImgBar.width=0,this.ulblTar.node.color=(new cc.Color).fromHEX("#4b91e4")},t.prototype.updateProress=function(){var e=a.gameModule.getMaxValue(),t=Math.floor(e/15*585);cc.tween(this.uImgBar).to(.3,{width:t},{easing:cc.easing.cubicInOut}).start()},i([l(cc.Label)],t.prototype,"ulblTar",void 0),i([l(cc.Node)],t.prototype,"uImgBar",void 0),i([u],t)}(cc.Component);o.default=s,cc._RF.pop()},{"../dataModule/GameModule":"GameModule"}],MergeScene:[function(e,t,o){"use strict";cc._RF.push(t,"0af54diud5JN6SYpIPIvcRc","MergeScene");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},a=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(r,i){function a(e){try{u(n.next(e))}catch(t){i(t)}}function c(e){try{u(n.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}u((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(e){return function(t){return u([e,t])}}function u(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(c){i=[6,c],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var u=e("../dataModule/PlayerModule"),l=e("../define/TypeDefine"),s=e("../manager/AudioMgr"),d=e("../manager/Uimanager"),p=cc._decorator,f=p.ccclass,h=p.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uBtnStart=null,t}return r(t,e),t.prototype.onLoad=function(){console.log("load mergeScene"),this.uBtnStart.on(cc.Node.EventType.TOUCH_END,this.onStart,this),this.uBtnStart.active=!1},t.prototype.start=function(){var e=this;d.uimanager.init(this.node),u.playerModule.login(function(){s.audioMgr.init(),e.initUI()}),this.onShow(),this.onHide()},t.prototype.update=function(){d.uimanager.udpateLayerShow()},t.prototype.onStart=function(){this.initGamePanel()},t.prototype.initUI=function(){this.uBtnStart.active=!0,this.initTopCom()},t.prototype.initTopCom=function(){return a(this,void 0,void 0,function(){var e,t;return c(this,function(o){switch(o.label){case 0:return[4,d.uimanager.loadPrefab("prefab/zyx/uComTop")];case 1:return e=o.sent(),t=cc.instantiate(e),d.uimanager.add(t,l.LAYER.UI),t.setPosition(new cc.Vec2(0,0)),[2]}})})},t.prototype.initGamePanel=function(){return a(this,void 0,void 0,function(){var e,t;return c(this,function(o){switch(o.label){case 0:return[4,d.uimanager.loadPrefab("prefab/merge/game")];case 1:return e=o.sent(),t=cc.instantiate(e),d.uimanager.add(t,l.LAYER.UI),t.setPosition(new cc.Vec2(0,0)),[2]}})})},t.prototype.onShow=function(){window.wx&&wx.onShow(function(){console.log("onShow")})},t.prototype.onHide=function(){window.wx&&wx.onHide(function(){console.log("onHide")})},i([h(cc.Node)],t.prototype,"uBtnStart",void 0),i([f],t)}(cc.Component);o.default=y,cc._RF.pop()},{"../dataModule/PlayerModule":"PlayerModule","../define/TypeDefine":"TypeDefine","../manager/AudioMgr":"AudioMgr","../manager/Uimanager":"Uimanager"}],NewUtils:[function(e,t,o){"use strict";cc._RF.push(t,"85100MR3/pMT5YtpOTF2CAl","NewUtils"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.deepClone=function(e,t){if(void 0===t&&(t=new WeakMap),"object"!=typeof e)return e;if(null===e)return e;if(t.get(e))return t.get(e);if(e instanceof Date)return new Date(e);if(e instanceof RegExp)return new RegExp(e);var o=new e.constructor;for(var n in t.set(e,o),e)e[n]&&(o[n]=this.deepClone(e[n],t));return o},e.randomIntInclusive=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e},e.randomIntArrFromSection=function(e,t,o){var n=[];do{var r=this.randomIntInclusive(t,o);-1===n.indexOf(r)&&n.push(r)}while(n.length<e);return n},e.randomIntArrInclusive=function(e,t,o){var n=[];do{n.push(this.randomIntInclusive(t,o))}while(n.length<e);return n},e.randomIntArrFromArr=function(e,t){var o=[];do{var n=this.randomIntInclusive(0,t.length-1);o.push(t[n])}while(o.length<e);return o},e.sumArrayNum=function(e){for(var t=0,o=0;o<e.length;o++)t+=e[o];return t},e.setSpriteFrameByUrl=function(e,t){cc.resources.load(t,cc.SpriteFrame,function(o,n){o?console.error("url:",t,"/err:"):e.spriteFrame=n})},e}();o.default=n,cc._RF.pop()},{}],PlayerModule:[function(e,t,o){"use strict";cc._RF.push(t,"b9091AjnB9Hj67aGxm4Vaq5","PlayerModule");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.playerModule=void 0;var i=e("./DataModule"),a=e("./GameModule"),c=e("./GoodsModule"),u=e("./ZyxGameModule"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.diamond=0,t.star=0,t.hammer=0,t.bomb=0,t.nickName="",t.avatar="",t.lv=0,t.exp=0,t.expTar=0,t}return r(t,e),t.prototype.parseData=function(t){e.prototype.parseData.call(this,t)},t.prototype.login=function(e){var t={diamond:10,star:3,bomb:3,hammer:3,nickName:"\u6d4b\u8bd5\u7528\u6237",avatar:"",lv:1,exp:10,expTar:100,gameInfo:{adTimes:3,score:0,exp:0,diamond:0,star:0}};a.gameModule.parseData(t),c.goodsModule.parseData(t),u.zyxGameModule.parseData(t),setTimeout(function(){e&&e()},1e3)},t}(i.default);o.default=l,o.playerModule=new l,cc._RF.pop()},{"./DataModule":"DataModule","./GameModule":"GameModule","./GoodsModule":"GoodsModule","./ZyxGameModule":"ZyxGameModule"}],Slot:[function(e,t,o){"use strict";cc._RF.push(t,"dcad5zWGmVAHYWaggo3w0WB","Slot");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},a=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(r,i){function a(e){try{u(n.next(e))}catch(t){i(t)}}function c(e){try{u(n.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}u((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(e){return function(t){return u([e,t])}}function u(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(c){i=[6,c],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var u=e("../dataModule/GameModule"),l=e("../manager/AudioMgr"),s=e("../manager/Define"),d=e("../manager/Uimanager"),p=e("../util/EventManager"),f=e("./Coin"),h=cc._decorator,y=h.ccclass,g=h.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.idx=0,t.coinOriginalPos=[[58,197],[58,178],[58,159.3],[58,140],[58,121],[58,102],[58,83],[58,64],[58,45],[58,26]],t.coin0=null,t.coin1=null,t.coin2=null,t.coin3=null,t.coin4=null,t.coin5=null,t.coin6=null,t.coin7=null,t.coin8=null,t.coin9=null,t.uImgSlotSelect=null,t.uImgSlotMerge=null,t}return r(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.selectAction,this),p.eventManager.on(s.EventType.MOVE_COIN,this.onMove,this),p.eventManager.on(s.EventType.MOVE_END,this.onMoveEnd,this),p.eventManager.on(s.EventType.CHECK_MERGE,this.onUpdateMergeStatus,this),p.eventManager.on(s.EventType.MERGE_COIN,this.onMerge,this),p.eventManager.on(s.EventType.MOVE_CHECK_FAIL,this.canNotMove,this),p.eventManager.on(s.EventType.CANCEL_SELECT,this.onDeSelect,this)},t.prototype.start=function(){},t.prototype.formatData=function(e,t){var o=this;this.idx=e;for(var n=function(e){0!==t[e]?r["coin"+e].getComponent(f.default).init(r.idx,t[e],function(){o["coin"+e].active=!0}):r["coin"+e].active=!1,r["coin"+e].setPosition(cc.v2(r.coinOriginalPos[e][0],r.coinOriginalPos[e][1]))},r=this,i=0;i<10;i++)n(i);this.node.setSiblingIndex(this.idx)},t.prototype.selectAction=function(){-1===u.gameModule.curSelectSlotIdx?this.onSelect():u.gameModule.curSelectSlotIdx===this.idx?this.onDeSelect():this.onCheckMove()},t.prototype.onSelect=function(){var e=u.gameModule.slotData[this.idx];if(0!==e[0])if(u.gameModule.mergeLock)console.log("\u6b63\u5728\u5408\u5e76\u4e2d\uff0c\u65e0\u6cd5\u9009\u4e2d");else{u.gameModule.curSelectSlotIdx=this.idx,this.uImgSlotSelect.active=!0,this.node.setSiblingIndex(8),u.gameModule.curSelectCoinIdxs=[];for(var t=9;t>=0;t--)if(0!==e[t])if(0===u.gameModule.curSelectCoinIdxs.length)u.gameModule.curSelectCoinIdxs.push(t);else{if(e[t]!==e[u.gameModule.curSelectCoinIdxs[u.gameModule.curSelectCoinIdxs.length-1]])break;u.gameModule.curSelectCoinIdxs.push(t)}for(console.log("\u9009\u4e2d\u4e86\u7b2c"+this.idx+"\u4e2a\u69fd\u7684",u.gameModule.curSelectCoinIdxs),t=0;t<u.gameModule.curSelectCoinIdxs.length;t++){var o=this.coinOriginalPos[u.gameModule.curSelectCoinIdxs[t]][1]+25;cc.tween(this["coin"+u.gameModule.curSelectCoinIdxs[t]]).to(.5,{y:o},{easing:"backOut"}).start()}}else console.log("\u9009\u4e2d\u4e86\u7a7a\u7684\u69fd\u4f4d")},t.prototype.onDeSelect=function(){console.log("\u53d6\u6d88\u9009\u62e9");for(var e=0;e<10;e++){var t=this.coinOriginalPos[e][1];cc.tween(this["coin"+e]).to(.5,{y:t},{easing:"backOut"}).start()}this.uImgSlotSelect.active=!1,u.gameModule.curSelectSlotIdx=-1},t.prototype.onCheckMove=function(){if(-1===u.gameModule.slotData[this.idx].indexOf(0))return console.log("\u7b79\u7801\u6570\u91cf\u5df2\u6ee1\uff0c\u4e0d\u53ef\u79fb\u52a8"),void p.eventManager.dispatch(s.EventType.MOVE_CHECK_FAIL);var e=u.gameModule.getFirstVaildNumBySlotIdx(this.idx),t=u.gameModule.getCurSelectSlotInfo();if(-1!==e.vaildNum&&e.vaildNum!==t.num)return console.log("\u7b79\u7801\u7c7b\u578b\u4e0d\u4e00\u81f4, \u4e0d\u53ef\u79fb\u52a8"),void p.eventManager.dispatch(s.EventType.MOVE_CHECK_FAIL);if(u.gameModule.moveLock)console.log("\u6b63\u5728\u79fb\u52a8\u4e2d\uff0c\u65e0\u6cd5\u4ea7\u751f\u66f4\u591a\u79fb\u52a8");else{for(var o=Math.min(e.vaildSpace,t.cnt),n=[],r=[],i=[],a=e.vaildIdx+1,c=0;c<o;c++){var l=this.coinOriginalPos[a][0],d=this.coinOriginalPos[a][1],f=this.node.convertToWorldSpaceAR(cc.v2(l,d));n.push(f),r.push(a),i.push(u.gameModule.curSelectCoinIdxs[c]),a++}var h={moveCnt:o,tarPos:n,tarIdxArr:r,srcIdxArr:i,numType:t.num,tarSlotIdx:this.idx};p.eventManager.dispatch(s.EventType.MOVE_COIN,h)}},t.prototype.canNotMove=function(){var e=this;if(u.gameModule.curSelectSlotIdx===this.idx&&-1!==u.gameModule.curSelectSlotIdx){l.audioMgr.playSound(l.SoundType.ERROR);for(var t=function(t){var n=o["coin"+u.gameModule.curSelectCoinIdxs[t]],r=n.x;cc.tween(n).to(.05,{x:r-10}).to(.1,{x:r+10}).to(.1,{x:r-10}).to(.05,{x:r}).call(function(){t===u.gameModule.curSelectCoinIdxs.length-1&&e.onDeSelect()}).start()},o=this,n=0;n<u.gameModule.curSelectCoinIdxs.length;n++)t(n)}},t.prototype.onMove=function(e){var t=this,o=e.data;if(this.idx===u.gameModule.curSelectSlotIdx){console.log("onMove: "+u.gameModule.curSelectSlotIdx+" -> "+o.tarSlotIdx),l.audioMgr.playSound(l.SoundType.MOVE_COIN),u.gameModule.moveLock=!0;for(var n=o.moveCnt,r=o.tarPos,i=[],a=r.length-1;a>=0;a--)i.push(this.node.convertToNodeSpaceAR(r[a]));var c=u.gameModule.curSelectCoinIdxs[0],s=function(e){cc.tween(d["coin"+c]).delay(.03*e).to(.1,{position:i[e]}).call(function(){e===n-1&&(u.gameModule.tidySlotData({tarSlotIdx:o.tarSlotIdx,numType:o.numType,srcIdxArr:o.srcIdxArr,tarIdxArr:o.tarIdxArr}),t.onDeSelect(),u.gameModule.moveLock=!1)}).start(),c--},d=this;for(a=0;a<n;a++)s(a)}},t.prototype.onMoveEnd=function(){console.log("onMoveEnd"),this.formatData(this.idx,u.gameModule.slotData[this.idx])},t.prototype.onUpdateMergeStatus=function(){var e=u.gameModule.checkCanMergeBySlot(this.idx);this.uImgSlotMerge.active=e,this.showMergeHintAction(e)},t.prototype.showMergeHintAction=function(e){var t=this;e?(this.uImgSlotMerge.opacity=0,cc.tween(this.uImgSlotMerge).to(1,{opacity:255}).to(1,{opacity:0}).call(function(){t.showMergeHintAction(e)}).start()):(cc.tween(this.uImgSlotMerge).stop(),this.uImgSlotMerge.active=e)},t.prototype.onMerge=function(){var e=this;if(u.gameModule.checkCanMergeBySlot(this.idx)){l.audioMgr.playSound(l.SoundType.MERGE_COIN),u.gameModule.mergeLock+=1;for(var t=function(t){cc.tween(o["coin"+t]).delay(.05*(9-t)).to(.1,{scale:0}).call(function(){e["coin"+t].active=!1,e["coin"+t].scale=1,0===t&&e.onMergeFinish()}).start()},o=this,n=9;n>=0;n--)t(n)}},t.prototype.onMergeFinish=function(){var e=this,t=u.gameModule.slotData[this.idx][0]+1;u.gameModule.slotData[this.idx]=[t,t,0,0,0,0,0,0,0,0],console.log("\u69fd"+this.idx+" \u5408\u6210"+t),this.coin0.scale=0,this.coin1.scale=0,this.coin0.getComponent(f.default).init(this.idx,t,function(){e.coin0.active=!0}),this.coin1.getComponent(f.default).init(this.idx,t,function(){e.coin1.active=!0}),cc.tween(this.coin0).to(.5,{scale:1},{easing:"backOut"}).start(),cc.tween(this.coin1).to(.5,{scale:1},{easing:"backOut"}).call(function(){u.gameModule.mergeLock-=1,u.gameModule.mergeLock<0&&(u.gameModule.mergeLock=0),0===u.gameModule.mergeLock&&p.eventManager.dispatch(s.EventType.MERGE_END)}).start(),this.uImgSlotMerge.active=!1,p.eventManager.dispatch(s.EventType.CHECK_MERGE)},t.prototype.produce=function(e,t,o){return a(this,void 0,void 0,function(){var n,r,i,a,s,d=this;return c(this,function(p){switch(p.label){case 0:if(console.log(this.idx,e),0===e.length)return console.log(this.idx+"\u69fd\u65e0\u65b0\u7b79\u7801"),l.audioMgr.playSound(l.SoundType.ERROR),[2];console.log(this.idx+" \u751f\u6210\u4e86",e),n=this.node.convertToNodeSpaceAR(t),r=0,i=function(t){var i,l,s,p,h;return c(this,function(c){switch(c.label){case 0:return[4,a.produceCoin()];case 1:return i=c.sent(),l=i.getComponent(f.default),a.node.addChild(i),l.node.setPosition(n),l.node.active=!1,l.init(a.idx,e[t],function(){l.node.active=!0}),s=o+r,p=a.coinOriginalPos[o+r],h=cc.v2(p[0],p[1]),u.gameModule.produceLock+=1,cc.tween(l.node).delay(.1*r).to(.5,{position:h},{easing:"cubicInOut"}).call(function(){d["coin"+s].getComponent(f.default).init(d.idx,e[t],function(){d["coin"+s].active=!0,l.node.active=!1,l.node.destroy()}),u.gameModule.produceLock-=1,u.gameModule.produceLock<0&&(u.gameModule.produceLock=0)}).start(),r++,[2]}})},a=this,s=0,p.label=1;case 1:return s<e.length?[5,i(s)]:[3,4];case 2:p.sent(),p.label=3;case 3:return s++,[3,1];case 4:return[2]}})})},t.prototype.produceCoin=function(){return a(this,void 0,Promise,function(){var e;return c(this,function(t){switch(t.label){case 0:return[4,d.uimanager.loadPrefab("prefab/merge/coin")];case 1:return e=t.sent(),[2,cc.instantiate(e)]}})})},i([g(cc.Node)],t.prototype,"coin0",void 0),i([g(cc.Node)],t.prototype,"coin1",void 0),i([g(cc.Node)],t.prototype,"coin2",void 0),i([g(cc.Node)],t.prototype,"coin3",void 0),i([g(cc.Node)],t.prototype,"coin4",void 0),i([g(cc.Node)],t.prototype,"coin5",void 0),i([g(cc.Node)],t.prototype,"coin6",void 0),i([g(cc.Node)],t.prototype,"coin7",void 0),i([g(cc.Node)],t.prototype,"coin8",void 0),i([g(cc.Node)],t.prototype,"coin9",void 0),i([g(cc.Node)],t.prototype,"uImgSlotSelect",void 0),i([g(cc.Node)],t.prototype,"uImgSlotMerge",void 0),i([y],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../dataModule/GameModule":"GameModule","../manager/AudioMgr":"AudioMgr","../manager/Define":"Define","../manager/Uimanager":"Uimanager","../util/EventManager":"EventManager","./Coin":"Coin"}],Tips:[function(e,t,o){"use strict";cc._RF.push(t,"62421poWOhEyaA6Xq8Q9pp/","Tips");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,c=a.ccclass,u=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ulblTips=null,t.uImgBg=null,t}return r(t,e),t.prototype.onLoad=function(){this.node.opacity=0},t.prototype.start=function(){},t.prototype.showTips=function(e){var t=this;this.ulblTips.string=e,this.node.y=-200,this.node.opacity=0,cc.tween(this.node).to(.6,{opacity:255,y:0},{easing:"cubicInOut"}).delay(1).to(.8,{opacity:0,y:50},{easing:"cubicInOut"}).call(function(){t.node.removeFromParent()}).start()},i([u(cc.Label)],t.prototype,"ulblTips",void 0),i([u(cc.Sprite)],t.prototype,"uImgBg",void 0),i([c],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],TouchEffect:[function(e,t,o){"use strict";cc._RF.push(t,"ba1070sT7NPqKINxiKgj14u","TouchEffect");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,c=a.ccclass,u=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scaleTime=.07,t.initScaleX=1,t.initScaleY=1,t.dS=.9,t}return r(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this)},t.prototype.start=function(){this.initScaleX=this.node.scaleX,this.initScaleY=this.node.scaleY,cc.tween(this.node).stop()},t.prototype.onTouchStart=function(){var e=.9*this.node.scaleX,t=.9*this.node.scaleY;cc.tween(this.node).to(this.scaleTime,{scaleX:e,scaleY:t}).to(this.scaleTime,{scaleX:this.initScaleX,scaleY:this.initScaleY}).start()},t.prototype.onTouchEnd=function(){cc.tween(this.node).to(this.scaleTime,{scaleX:this.initScaleX,scaleY:this.initScaleY}).start()},i([u()],t.prototype,"scaleTime",void 0),i([c],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],TypeDefine:[function(e,t,o){"use strict";cc._RF.push(t,"26083HQUZhNsJndxpxVjML2","TypeDefine"),Object.defineProperty(o,"__esModule",{value:!0}),o.gridContentType=o.gridSize=o.LAYER=void 0,function(e){e.UI="ui",e.DIALOG="dialog",e.TIP="tip",e.GUIDE="guide"}(o.LAYER||(o.LAYER={})),function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR"}(o.gridSize||(o.gridSize={})),function(e){e[e.EMPTY=0]="EMPTY",e[e.NORMAL=1]="NORMAL",e[e.DIAMOND=2]="DIAMOND",e[e.BOMB=3]="BOMB",e[e.HAMMER=4]="HAMMER"}(o.gridContentType||(o.gridContentType={})),cc._RF.pop()},{}],Uimanager:[function(e,t,o){"use strict";cc._RF.push(t,"f6b0eaEb8lOraTr9sfkeyyf","Uimanager");var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(r,i){function a(e){try{u(n.next(e))}catch(t){i(t)}}function c(e){try{u(n.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}u((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(e){return function(t){return u([e,t])}}function u(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(c){i=[6,c],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.uimanager=void 0;var i=e("../define/TypeDefine"),a=e("../pulicCom/Tips"),c=function(){function e(){this.scene=null,this.layerArr=[]}return Object.defineProperty(e,"instance",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!1,configurable:!0}),e.prototype.init=function(e){this.scene=e,this.initLayer()},e.prototype.initLayer=function(){this.layerArr=[];var e=new cc.Node(i.LAYER.UI);e.width=this.scene.width,e.height=this.scene.height,this.scene.addChild(e),this.layerArr.push(e);var t=new cc.Node(i.LAYER.DIALOG);t.width=this.scene.width,t.height=this.scene.height,this.scene.addChild(t),this.layerArr.push(t);var o=new cc.Node(i.LAYER.TIP);o.width=this.scene.width,o.height=this.scene.height,this.scene.addChild(o),this.layerArr.push(o);var n=new cc.Node(i.LAYER.GUIDE);n.width=this.scene.width,n.height=this.scene.height,this.scene.addChild(n),this.layerArr.push(n)},e.prototype.getLayer=function(e){return this.scene.getChildByName(e)},e.prototype.add=function(e,t){var o=this.getLayer(t);o?o.addChild(e):console.warn("UIManager: \u6ca1\u6709\u8fd9\u4e2a\u5c42\u7ea7",t)},e.prototype.udpateLayerShow=function(){for(var e=0;e<this.layerArr.length;e++)this.layerArr[e].active=this.layerArr[e].childrenCount>0},e.prototype.loadPrefab=function(e){return n(this,void 0,Promise,function(){var t=this;return r(this,function(){return[2,new Promise(function(o,i){return n(t,void 0,void 0,function(){var t=this;return r(this,function(a){switch(a.label){case 0:return[4,n(t,void 0,void 0,function(){return r(this,function(){return[2,new Promise(function(t,o){var n=setTimeout(function(){console.debug("[loadPefab timeout] "+e+"\u52a0\u8f7d\u8d85\u65f6"),o("loadPefab \u8fde\u63a5\u8d85\u65f6"+e)},1e4);cc.resources.load(e,function(e,r){clearTimeout(n),e?o(e):t(r)})})]})}).then(function(e){o(e)}).catch(function(e){i(e)})];case 1:return a.sent(),[2]}})})})]})})},e.prototype.showTips=function(e){return n(this,void 0,void 0,function(){var t,o;return r(this,function(n){switch(n.label){case 0:return[4,this.loadPrefab("prefab/com/tips")];case 1:return t=n.sent(),o=cc.instantiate(t),this.add(o,i.LAYER.TIP),o.getComponent(a.default).showTips(e),o.setPosition(0,0),[2]}})})},e.prototype.showGameOver=function(){return n(this,void 0,void 0,function(){var e,t;return r(this,function(n){switch(n.label){case 0:return o.uimanager.showTips("\u6e38\u620f\u7ed3\u675f"),[4,this.loadPrefab("prefab/zyx/accountDialog")];case 1:return e=n.sent(),t=cc.instantiate(e),this.add(t,i.LAYER.UI),t.setPosition(0,0),[2]}})})},e}();o.default=c,o.uimanager=c.instance,cc._RF.pop()},{"../define/TypeDefine":"TypeDefine","../pulicCom/Tips":"Tips"}],ZyxAccountDialog:[function(e,t,o){"use strict";cc._RF.push(t,"ef5253/VKlPL5QaowdjMHpL","ZyxAccountDialog");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../dataModule/ZyxGameModule"),c=e("../manager/Define"),u=e("../util/EventManager"),l=cc._decorator,s=l.ccclass,d=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ulblTitle=null,t.ulblScore=null,t.uBox=null,t.uBtnOk=null,t}return r(t,e),t.prototype.onLoad=function(){this.uBtnOk.on(cc.Node.EventType.TOUCH_END,this.close,this)},t.prototype.start=function(){this.ulblScore.string="\u5f97\u5206\uff1a"+a.zyxGameModule.gameInfo.score},t.prototype.close=function(){var e=this;a.zyxGameModule.gameInfo={adTimes:3,score:0,exp:0,diamond:0,star:0},u.eventManager.dispatch(c.EventType.ZYX_RESET_GAME),cc.tween(this.node).to(.2,{scale:0}).call(function(){e.node.destroy()}).start()},i([d(cc.Label)],t.prototype,"ulblTitle",void 0),i([d(cc.Label)],t.prototype,"ulblScore",void 0),i([d(cc.Node)],t.prototype,"uBox",void 0),i([d(cc.Node)],t.prototype,"uBtnOk",void 0),i([s],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../dataModule/ZyxGameModule":"ZyxGameModule","../manager/Define":"Define","../util/EventManager":"EventManager"}],ZyxComTop:[function(e,t,o){"use strict";cc._RF.push(t,"ff575bO8YtMEauFEhjl6YgO","ZyxComTop");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../dataModule/PlayerModule"),c=e("../dataModule/ZyxGameModule"),u=cc._decorator,l=u.ccclass,s=u.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uImgExpBar=null,t.ulblLv=null,t.ulblExp=null,t.uImgAvatar=null,t.ulblDiamond=null,t.ulblStar=null,t}return r(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},t.prototype.init=function(){this.ulblStar.string=""+c.zyxGameModule.gameInfo.star,this.ulblLv.string=""+a.playerModule.lv,this.ulblExp.string=a.playerModule.exp+"/"+a.playerModule.expTar,this.ulblDiamond.string=""+a.playerModule.diamond,this.ulblStar.string=""+a.playerModule.star},i([s(cc.Node)],t.prototype,"uImgExpBar",void 0),i([s(cc.Label)],t.prototype,"ulblLv",void 0),i([s(cc.Label)],t.prototype,"ulblExp",void 0),i([s(cc.Node)],t.prototype,"uImgAvatar",void 0),i([s(cc.Label)],t.prototype,"ulblDiamond",void 0),i([s(cc.Label)],t.prototype,"ulblStar",void 0),i([l],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../dataModule/PlayerModule":"PlayerModule","../dataModule/ZyxGameModule":"ZyxGameModule"}],ZyxGameModule:[function(e,t,o){"use strict";cc._RF.push(t,"13772iquZdC5IRf5xG8UarI","ZyxGameModule");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.zyxGameModule=void 0;var i=e("../define/TypeDefine"),a=e("../util/NewUtils"),c=function(e){function t(){var t=e.call(this)||this;return t.gameInfo=null,t.gridInfo=[[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]]],t.selectGirdUniqueId=-1,t.uniqueId=9,t.gridsWidth=84,t.nextGridInfo=[],t}return r(t,e),t.prototype.parseData=function(t){e.prototype.parseData.call(this,t),this.gameInfo=t.gameInfo,this.gridInfo=t.gridInfo||[[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[2,1,1],[2,1,1],[0,0,0],[0,0,0]],[[1,1,2],[1,1,3],[1,1,4],[1,1,5],[1,1,6],[1,1,7],[0,0,0],[0,0,0]]],this.produce()},t.prototype.produce=function(){var e=[];do{var t=a.default.randomIntInclusive(0,10);if(t>=0&&t<4?t=0:t>=4&&t<6?t=1:t>=6&&t<8?t=2:t>=8&&t<10?t=3:10===t&&(t=4),0===t)e.push([0,0,0]);else{var o=8-e.length,n=e.filter(function(e){return e&&e[1]===i.gridContentType.EMPTY});if(o<=t&&0===n.length){for(var r=0;r<o;r++)e.push([0,0,0]);break}if(o>=t)for(this.uniqueId++,r=0;r<t;r++)e.push([t,1,this.uniqueId])}}while(e.length<8);return this.nextGridInfo=e,console.log("produce",e),e},t.prototype.checkGameOver=function(){for(var e=!1,t=0;t<this.gridInfo[0].length;t++)this.gridInfo[0][t][1]!==i.gridContentType.EMPTY&&(e=!0);return e},t.prototype.copyNewGridData=function(){for(var e=[],t=0;t<this.nextGridInfo.length;t++){var o=[0,0,0];o[0]=this.nextGridInfo[t][0],o[1]=this.nextGridInfo[t][1],o[2]=this.nextGridInfo[t][2],e.push(o)}return e},t}(e("./DataModule").default);o.default=c,o.zyxGameModule=new c,cc._RF.pop()},{"../define/TypeDefine":"TypeDefine","../util/NewUtils":"NewUtils","./DataModule":"DataModule"}],ZyxGame:[function(e,t,o){"use strict";cc._RF.push(t,"227d6ZY3XNCDbSywxs/Ei3N","ZyxGame");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},a=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(r,i){function a(e){try{u(n.next(e))}catch(t){i(t)}}function c(e){try{u(n.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}u((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(e){return function(t){return u([e,t])}}function u(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(c){i=[6,c],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var u=e("../dataModule/PlayerModule"),l=e("../dataModule/ZyxGameModule"),s=e("../define/TypeDefine"),d=e("../manager/AudioMgr"),p=e("../manager/Define"),f=e("../manager/Uimanager"),h=e("../util/EventManager"),y=e("./ZyxGridCom"),g=e("./ZyxLineCom"),m=cc._decorator,v=m.ccclass,M=m.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ulblScore=null,t.ulblDiamond=null,t.ulblStarCnt=null,t.ulblHammerCnt=null,t.ulblBombCnt=null,t.ulblAdCnt=null,t.uImgStarBar=null,t.uBtnHammer=null,t.uBtnBomb=null,t.uBtnClean=null,t.uBoxGrid=null,t.uBoxNew=null,t.grids=[],t.hasDropAction=!1,t.hasProduce=!1,t.timeGridDrop=.2,t.timeWaitDrop=600,t.timeShowNewGrids=.44,t}return r(t,e),t.prototype.onLoad=function(){this.uBtnClean.on(cc.Node.EventType.TOUCH_END,this.test,this),h.eventManager.on(p.EventType.ZYX_CHECK_MERGE,this.check,this),h.eventManager.on(p.EventType.ZYX_RESET_GAME,this.resetGame,this),this.initUI()},t.prototype.start=function(){},t.prototype.resetGame=function(){l.zyxGameModule.gridInfo=[[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[3,1,1],[3,1,1],[3,1,1],[0,0,0],[0,0,0],[0,0,0]],[[1,1,2],[1,1,3],[1,1,4],[1,1,5],[1,1,6],[1,1,7],[1,1,8],[1,1,9]]],l.zyxGameModule.produce(),this.hasProduce=!1,l.zyxGameModule.selectGirdUniqueId=-1,this.initUI()},t.prototype.initUI=function(){this.ulblScore.string=""+l.zyxGameModule.gameInfo.score,this.ulblDiamond.string=""+l.zyxGameModule.gameInfo.diamond,this.ulblStarCnt.string=""+l.zyxGameModule.gameInfo.star,this.ulblAdCnt.string="("+l.zyxGameModule.gameInfo.adTimes+")",this.ulblHammerCnt.string=""+u.playerModule.hammer,this.ulblBombCnt.string=""+u.playerModule.bomb,this.initChessBoard(),setTimeout(function(){d.audioMgr.playBGM(d.SoundType.ZYX_MUSIC_GAME)},1e3)},t.prototype.initChessBoard=function(){return a(this,void 0,void 0,function(){var e,t,o;return c(this,function(n){switch(n.label){case 0:this.uBoxGrid.destroyAllChildren(),this.grids=[],e=0,n.label=1;case 1:if(!(e<l.zyxGameModule.gridInfo.length))return[3,9];t=0,n.label=2;case 2:return t<l.zyxGameModule.gridInfo[e].length?0!==t?[3,5]:l.zyxGameModule.gridInfo[e][t][1]===s.gridContentType.EMPTY?[3,4]:[4,this.produceGrid(l.zyxGameModule.gridInfo[e][t])]:[3,8];case 3:o=n.sent(),this.uBoxGrid.addChild(o),o.setPosition(new cc.Vec2(l.zyxGameModule.gridsWidth*t,l.zyxGameModule.gridsWidth*(10-e)-l.zyxGameModule.gridsWidth)),o.getComponent(y.default).setRowCel(e,t),this.grids.push(o),n.label=4;case 4:return[3,7];case 5:return l.zyxGameModule.gridInfo[e][t][1]==s.gridContentType.EMPTY||l.zyxGameModule.gridInfo[e][t][2]===l.zyxGameModule.gridInfo[e][t-1][2]?[3,7]:[4,this.produceGrid(l.zyxGameModule.gridInfo[e][t])];case 6:o=n.sent(),this.uBoxGrid.addChild(o),o.setPosition(new cc.Vec2(l.zyxGameModule.gridsWidth*t,l.zyxGameModule.gridsWidth*(10-e)-l.zyxGameModule.gridsWidth)),o.getComponent(y.default).setRowCel(e,t),this.grids.push(o),n.label=7;case 7:return t++,[3,2];case 8:return e++,[3,1];case 9:return[2]}})})},t.prototype.loadNext=function(){this.moveUp(),this.produceRow()},t.prototype.produceRow=function(){return a(this,void 0,void 0,function(){var e,t,o,n;return c(this,function(r){switch(r.label){case 0:l.zyxGameModule.gridInfo.shift(),e=l.zyxGameModule.copyNewGridData(),l.zyxGameModule.gridInfo.push(e),t=0,r.label=1;case 1:return t<8?(o=9,0!==t?[3,4]:l.zyxGameModule.gridInfo[o][t][1]===s.gridContentType.EMPTY?[3,3]:[4,this.produceGrid(l.zyxGameModule.gridInfo[o][t])]):[3,7];case 2:n=r.sent(),this.uBoxGrid.addChild(n),n.setPosition(new cc.Vec2(l.zyxGameModule.gridsWidth*t,-84)),n.getComponent(y.default).setRowCel(o,t),this.grids.push(n),r.label=3;case 3:return[3,6];case 4:return l.zyxGameModule.gridInfo[o][t][1]==s.gridContentType.EMPTY||l.zyxGameModule.gridInfo[o][t][2]===l.zyxGameModule.gridInfo[o][t-1][2]?[3,6]:[4,this.produceGrid(l.zyxGameModule.gridInfo[o][t])];case 5:n=r.sent(),this.uBoxGrid.addChild(n),n.setPosition(new cc.Vec2(l.zyxGameModule.gridsWidth*t,-84)),n.getComponent(y.default).setRowCel(o,t),this.grids.push(n),r.label=6;case 6:return t++,[3,1];case 7:return this.showNewGrids(),[2]}})})},t.prototype.produceGrid=function(e){return a(this,void 0,void 0,function(){var t,o;return c(this,function(n){switch(n.label){case 0:return[4,f.uimanager.loadPrefab("prefab/zyx/uComGrid")];case 1:return t=n.sent(),(o=cc.instantiate(t)).getComponent(y.default).init(e),[2,o]}})})},t.prototype.showNewGrids=function(){for(var e=this,t=!1,o=0;o<this.grids.length;o++){var n=this.grids[o];-84===n.y&&cc.tween(n).to(this.timeShowNewGrids,{y:n.y+84},{easing:"cubicInOut"}).call(function(){t||(t=!0,e.check())}).start()}this.updateNextGrid()},t.prototype.moveUp=function(){for(var e=0;e<this.grids.length;e++){var t=this.grids[e];cc.tween(t).to(this.timeShowNewGrids,{y:t.y+84},{easing:"cubicInOut"}).start(),t.getComponent(y.default).moveUp()}},t.prototype.updateNextGrid=function(){return a(this,void 0,void 0,function(){var e,t;return c(this,function(o){switch(o.label){case 0:l.zyxGameModule.produce(),this.uBoxNew.destroyAllChildren(),e=0,o.label=1;case 1:return e<8?0!==e?[3,4]:l.zyxGameModule.nextGridInfo[e][1]===s.gridContentType.EMPTY?[3,3]:[4,this.produceNewLine(l.zyxGameModule.nextGridInfo[e][0])]:[3,7];case 2:t=o.sent(),this.uBoxNew.addChild(t),t.setPosition(new cc.Vec2(l.zyxGameModule.gridsWidth*e,0)),o.label=3;case 3:return[3,6];case 4:return l.zyxGameModule.nextGridInfo[e][1]==s.gridContentType.EMPTY||l.zyxGameModule.nextGridInfo[e][2]===l.zyxGameModule.nextGridInfo[e-1][2]?[3,6]:[4,this.produceNewLine(l.zyxGameModule.nextGridInfo[e][0])];case 5:t=o.sent(),this.uBoxNew.addChild(t),t.setPosition(new cc.Vec2(l.zyxGameModule.gridsWidth*e,0)),o.label=6;case 6:return e++,[3,1];case 7:return[2]}})})},t.prototype.produceNewLine=function(e){return a(this,void 0,void 0,function(){var t,o;return c(this,function(n){switch(n.label){case 0:return[4,f.uimanager.loadPrefab("prefab/zyx/uComNextLine")];case 1:return t=n.sent(),(o=cc.instantiate(t)).getComponent(g.default).setW(e*l.zyxGameModule.gridsWidth),[2,o]}})})},t.prototype.check=function(){this.drop(9)},t.prototype.merge=function(){for(var e=0,t=0;t<l.zyxGameModule.gridInfo.length;t++){for(var o=l.zyxGameModule.gridInfo[t],n=!1,r=0;r<o.length;r++)if(o[r][1]===s.gridContentType.EMPTY){n=!0;break}var i=[];if(!n)for(e++,r=0;r<o.length;r++)-1===i.indexOf(o[r][2])&&0!==o[r][2]&&i.push(o[r][2]),l.zyxGameModule.gridInfo[t][r]=[0,0,0];for(var a=0;a<i.length;a++){var c=i[a];this.eliminateGrid(c)}}if(e>0)f.uimanager.showTips("\u767c\u751f\u6d88\u9664\uff0c\u6301\u7eed\u4e0b\u4e00\u8f6e\u68c0\u6d4b"),d.audioMgr.shake(d.SHAKE_TYPE.HEAVY),this.addScore(e),this.check();else{var u=this.checkGameOver(),p=this.checkGridEmpty();if(u)return;this.hasProduce?p?(this.hasProduce=!0,this.loadNext(),f.uimanager.showTips("\u68cb\u76d8\u4e3a\u7a7a\uff0c\u5c55\u793a\u4e0b\u4e00\u884c")):(this.hasProduce=!1,l.zyxGameModule.selectGirdUniqueId=-1,console.log("action over:",l.zyxGameModule.gridInfo)):(this.hasProduce=!0,this.loadNext(),f.uimanager.showTips("\u5c55\u793a\u4e0b\u4e00\u884c"))}},t.prototype.checkGridEmpty=function(){for(var e=!0,t=0;t<l.zyxGameModule.gridInfo[9].length;t++)if(l.zyxGameModule.gridInfo[9][t][1]!==s.gridContentType.EMPTY){e=!1;break}return e},t.prototype.eliminateGrid=function(e){for(var t=0;t<this.grids.length;t++)if(this.grids[t].getComponent(y.default).uniqueId===e){console.log("\u6d88\u9664",e),this.grids[t].getComponent(y.default).eliminate(),this.grids.splice(t,1);break}},t.prototype.drop=function(e){var t=this;if(9===e&&(this.hasDropAction=!1),0!==e){for(var o=0;o<8;o++)l.zyxGameModule.gridInfo[e][o][1]!==s.gridContentType.EMPTY||l.zyxGameModule.gridInfo[e-1][o][1]===s.gridContentType.EMPTY||this.dropGrid(e-1,o)&&(this.hasDropAction=!0);this.drop(e-1)}else this.hasDropAction?(console.log("\u6301\u7eed\u6389\u843d\u68c0\u6d4b"),d.audioMgr.playSound(d.SoundType.ZYX_DROP),this.check()):setTimeout(function(){t.merge()},this.timeWaitDrop)},t.prototype.dropGrid=function(e,t){for(var o=l.zyxGameModule.gridInfo[e][t][2],n=[],r=0;r<8;r++)l.zyxGameModule.gridInfo[e][r][2]===o&&n.push(r);var i=!0;for(r=0;r<n.length;r++){var a=n[r];if(l.zyxGameModule.gridInfo[e+1][a][1]!==s.gridContentType.EMPTY)return i=!1,!1}for(r=0;r<n.length;r++){var c=n[r];l.zyxGameModule.gridInfo[e+1][c][0]=l.zyxGameModule.gridInfo[e][c][0],l.zyxGameModule.gridInfo[e+1][c][1]=l.zyxGameModule.gridInfo[e][c][1],l.zyxGameModule.gridInfo[e+1][c][2]=l.zyxGameModule.gridInfo[e][c][2],l.zyxGameModule.gridInfo[e][c][0]=0,l.zyxGameModule.gridInfo[e][c][1]=s.gridContentType.EMPTY,l.zyxGameModule.gridInfo[e][c][2]=0}for(console.log("\u6389\u843d:",o),r=0;r<this.grids.length;r++){var u=this.grids[r];if(u.getComponent(y.default).uniqueId===o){u.getComponent(y.default).moveDown();var d=l.zyxGameModule.gridsWidth*(10-e-1)-l.zyxGameModule.gridsWidth;cc.tween(u).to(this.timeGridDrop,{y:d},{easing:"quartIn"}).start()}}return i},t.prototype.checkGameOver=function(){return!!l.zyxGameModule.checkGameOver()&&(f.uimanager.showGameOver(),d.audioMgr.stopBGM(),d.audioMgr.shake(d.SHAKE_TYPE.HEAVY),d.audioMgr.playSound(d.SoundType.ZYX_END),!0)},t.prototype.addScore=function(e){l.zyxGameModule.gameInfo.score+=e,this.ulblScore.string=l.zyxGameModule.gameInfo.score.toString()},t.prototype.test=function(){console.log(l.zyxGameModule.gridInfo)},i([M(cc.Label)],t.prototype,"ulblScore",void 0),i([M(cc.Label)],t.prototype,"ulblDiamond",void 0),i([M(cc.Label)],t.prototype,"ulblStarCnt",void 0),i([M(cc.Label)],t.prototype,"ulblHammerCnt",void 0),i([M(cc.Label)],t.prototype,"ulblBombCnt",void 0),i([M(cc.Label)],t.prototype,"ulblAdCnt",void 0),i([M(cc.Node)],t.prototype,"uImgStarBar",void 0),i([M(cc.Node)],t.prototype,"uBtnHammer",void 0),i([M(cc.Node)],t.prototype,"uBtnBomb",void 0),i([M(cc.Node)],t.prototype,"uBtnClean",void 0),i([M(cc.Node)],t.prototype,"uBoxGrid",void 0),i([M(cc.Node)],t.prototype,"uBoxNew",void 0),i([v],t)}(cc.Component);o.default=_,cc._RF.pop()},{"../dataModule/PlayerModule":"PlayerModule","../dataModule/ZyxGameModule":"ZyxGameModule","../define/TypeDefine":"TypeDefine","../manager/AudioMgr":"AudioMgr","../manager/Define":"Define","../manager/Uimanager":"Uimanager","../util/EventManager":"EventManager","./ZyxGridCom":"ZyxGridCom","./ZyxLineCom":"ZyxLineCom"}],ZyxGridCom:[function(e,t,o){"use strict";cc._RF.push(t,"91c73UehBpGm6f6owMD6XWE","ZyxGridCom");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../dataModule/ZyxGameModule"),c=e("../define/TypeDefine"),u=e("../manager/AudioMgr"),l=e("../manager/Define"),s=e("../manager/Uimanager"),d=e("../util/EventManager"),p=e("../util/NewUtils"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uImgDiamond=null,t.uImgBg=null,t.ulblUniqueId=null,t.size=c.gridSize.ONE,t.contentType=c.gridContentType.EMPTY,t.uniqueId=0,t.row=-1,t.col=-1,t.offsetCnt=0,t.originX=0,t.originGridX=0,t.timeDelGrid=.18,t}return r(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},t.prototype.start=function(){},t.prototype.init=function(e){if(this.size=e[0],this.contentType=e[1],this.uniqueId=e[2],this.contentType!==c.gridContentType.EMPTY){var t=84*e[0];this.node.width=t,this.uImgBg.width=this.node.width,this.uImgBg.x=t/2,this.uImgDiamond.x=this.uImgBg.width/2,this.ulblUniqueId.node.x=this.node.width/2,this.uImgDiamond.active=this.contentType===c.gridContentType.DIAMOND,this.ulblUniqueId.string=this.uniqueId.toString(),this.ulblUniqueId.node.active=!1;var o="images/grid/color_"+p.default.randomIntInclusive(1,13);p.default.setSpriteFrameByUrl(this.uImgBg.getComponent(cc.Sprite),o)}else this.node.active=!1},t.prototype.setRowCel=function(e,t){this.row=e,this.col=t},t.prototype.moveUp=function(){this.row-=1},t.prototype.moveDown=function(){this.row+=1},t.prototype.eliminate=function(){var e=this;this.size=c.gridSize.ZERO,this.contentType=c.gridContentType.EMPTY,this.uniqueId=-1,cc.tween(this.node).to(this.timeDelGrid,{opacity:0}).call(function(){e.node.removeFromParent()}).start()},t.prototype.onTouchStart=function(e){-1===a.zyxGameModule.selectGirdUniqueId&&(a.zyxGameModule.selectGirdUniqueId=this.uniqueId,console.log("onTouchStart",this.uniqueId,e.touch.getLocation().x),this.originX=e.touch.getLocation().x,this.originGridX=this.node.x,this.offsetCnt=0,u.audioMgr.shake(u.SHAKE_TYPE.LIGHT))},t.prototype.onTouchMove=function(e){if(a.zyxGameModule.selectGirdUniqueId===this.uniqueId){var t=e.touch.getLocation().x-this.originX;this.checkMove(t)&&(this.node.opacity=255,this.node.x=this.originGridX+a.zyxGameModule.gridsWidth*this.offsetCnt)}},t.prototype.onTouchEnd=function(){a.zyxGameModule.selectGirdUniqueId===this.uniqueId&&(console.log("onTouchEnd",this.uniqueId),this.moveCrossWise())},t.prototype.checkMove=function(e){var t=Math.floor(Math.abs(e)/a.zyxGameModule.gridsWidth),o=a.zyxGameModule.gridInfo[this.row],n=0;if(e>0)for(var r=this.col+this.size;r<8&&o[r][1]===c.gridContentType.EMPTY;r++)n++;else for(r=this.col-1;r>=0&&o[r][1]===c.gridContentType.EMPTY;r--)n++;return console.log("\u65b9\u5411:"+(e/Math.abs(e)>0?"\u53f3":"\u5de6")+" \u62d6\u52a8: "+t+", \u6700\u5927: "+n),Math.abs(t)<=n?(this.offsetCnt=e/Math.abs(e)*t,!0):(this.offsetCnt=e/Math.abs(e)*n,!1)},t.prototype.moveCrossWise=function(){if(0===this.offsetCnt||!this.offsetCnt)return console.log("\u6ca1\u6709\u53d1\u751f\u5b9e\u9645\u4f4d\u79fb, \u683c\u5b50\u9009\u4e2d\u72b6\u6001\u53d6\u6d88"),a.zyxGameModule.selectGirdUniqueId=-1,void(this.node.x=this.originGridX);this.offsetCnt>0?s.uimanager.showTips("\u53f3 -> "+this.offsetCnt):s.uimanager.showTips("\u5de6\u79fb <- "+-this.offsetCnt);for(var e=this.col;e<this.col+this.size;e++)a.zyxGameModule.gridInfo[this.row][e]=[0,0,0];var t=this.col+this.offsetCnt,o=t+this.size;for(e=t;e<o;e++)a.zyxGameModule.gridInfo[this.row][e][0]=this.size,a.zyxGameModule.gridInfo[this.row][e][1]=this.contentType,a.zyxGameModule.gridInfo[this.row][e][2]=this.uniqueId;this.setRowCel(this.row,this.col+this.offsetCnt),this.originGridX=this.node.x,d.eventManager.dispatch(l.EventType.ZYX_CHECK_MERGE),console.log("\u7b2c"+this.row+"\u884c\u53d1\u751f\u79fb\u52a8\uff1a",a.zyxGameModule.gridInfo)},i([y(cc.Node)],t.prototype,"uImgDiamond",void 0),i([y(cc.Node)],t.prototype,"uImgBg",void 0),i([y(cc.Label)],t.prototype,"ulblUniqueId",void 0),i([h],t)}(cc.Component);o.default=g,cc._RF.pop()},{"../dataModule/ZyxGameModule":"ZyxGameModule","../define/TypeDefine":"TypeDefine","../manager/AudioMgr":"AudioMgr","../manager/Define":"Define","../manager/Uimanager":"Uimanager","../util/EventManager":"EventManager","../util/NewUtils":"NewUtils"}],ZyxLineCom:[function(e,t,o){"use strict";cc._RF.push(t,"05b9cpMY9tNoKTFozkcF+5r","ZyxLineCom");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,c=a.ccclass,u=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uImgLine=null,t}return r(t,e),t.prototype.start=function(){},t.prototype.setW=function(e){this.uImgLine.width=e},i([u(cc.Node)],t.prototype,"uImgLine",void 0),i([c],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],ZyxMainScene:[function(e,t,o){"use strict";cc._RF.push(t,"384e0soW69C1KpfJCgBwNkn","ZyxMainScene");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},a=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(r,i){function a(e){try{u(n.next(e))}catch(t){i(t)}}function c(e){try{u(n.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(a,c)}u((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(e){return function(t){return u([e,t])}}function u(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(c){i=[6,c],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var u=e("../dataModule/PlayerModule"),l=e("../define/TypeDefine"),s=e("../manager/AudioMgr"),d=e("../manager/Uimanager"),p=e("./ZyxComTop"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uBtnStart=null,t.topCom=null,t}return r(t,e),t.prototype.onLoad=function(){console.log("load ZyxMainScene"),this.uBtnStart.on(cc.Node.EventType.TOUCH_END,this.onStart,this),this.uBtnStart.active=!1},t.prototype.start=function(){return a(this,void 0,void 0,function(){var e=this;return c(this,function(t){switch(t.label){case 0:return d.uimanager.init(this.node),[4,this.initTopCom()];case 1:return t.sent(),u.playerModule.login(function(){s.audioMgr.init(),e.initUI(),s.audioMgr.playBGM(s.SoundType.ZYX_MUSIC_MAIN)}),this.onShow(),this.onHide(),[2]}})})},t.prototype.update=function(){d.uimanager.udpateLayerShow()},t.prototype.onStart=function(){s.audioMgr.playSound(s.SoundType.ZYX_START),s.audioMgr.stopBGM(),this.initGamePanel()},t.prototype.initUI=function(){this.uBtnStart.active=!0,this.topCom.getComponent(p.default).init()},t.prototype.initTopCom=function(){return a(this,void 0,void 0,function(){var e,t;return c(this,function(o){switch(o.label){case 0:return[4,d.uimanager.loadPrefab("prefab/zyx/uComTop")];case 1:return e=o.sent(),t=cc.instantiate(e),d.uimanager.add(t,l.LAYER.UI),t.setPosition(new cc.Vec2(0,cc.winSize.height/2-t.height/2-50)),this.topCom=t,[2]}})})},t.prototype.initGamePanel=function(){return a(this,void 0,void 0,function(){var e,t;return c(this,function(o){switch(o.label){case 0:return[4,d.uimanager.loadPrefab("prefab/zyx/zyxGame")];case 1:return e=o.sent(),t=cc.instantiate(e),d.uimanager.add(t,l.LAYER.UI),t.setPosition(new cc.Vec2(0,0)),[2]}})})},t.prototype.onShow=function(){window.wx&&wx.onShow(function(){console.log("onShow")})},t.prototype.onHide=function(){window.wx&&wx.onHide(function(){console.log("onHide")})},i([y(cc.Node)],t.prototype,"uBtnStart",void 0),i([h],t)}(cc.Component);o.default=g,cc._RF.pop()},{"../dataModule/PlayerModule":"PlayerModule","../define/TypeDefine":"TypeDefine","../manager/AudioMgr":"AudioMgr","../manager/Uimanager":"Uimanager","./ZyxComTop":"ZyxComTop"}],ZyxRewardItem:[function(e,t,o){"use strict";cc._RF.push(t,"58f9eKomoVBuayMe+FsK7xm","ZyxRewardItem");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,c=a.ccclass,u=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uImgGoods=null,t.ulblCnt=null,t}return r(t,e),t.prototype.onLoad=function(){},t.prototype.start=function(){},i([u(cc.Sprite)],t.prototype,"uImgGoods",void 0),i([u(cc.Label)],t.prototype,"ulblCnt",void 0),i([c],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],logger:[function(e,t,o){"use strict";cc._RF.push(t,"ceb40nCofFAQac+7tmvBl9q","logger");var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,r++)n[r]=i[a];return n};Object.defineProperty(o,"__esModule",{value:!0}),o.Logger=void 0;var r=function(){function e(){}return e.Init=function(e){this.DEBUG_LOG=e},e.debug=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e.DEBUG_LOG&&console.log.apply(console,t)},e.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log.apply(console,e)},e.warn=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];e.DEBUG_LOG&&console.warn.apply(console,t)},e.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.error.apply(console,e)},e.assert=function(t,o){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];e.DEBUG_LOG&&console.assert.apply(console,n([t,o],r))},e.DEBUG_LOG=!0,e}();o.Logger=r,cc._RF.pop()},{}]},{},["DataModule","GameModule","GoodsModule","PlayerModule","ZyxGameModule","TypeDefine","Coin","Game","GoodsCom","GoodsList","MergeProgress","MergeScene","Slot","AudioMgr","Define","Uimanager","Tips","TouchEffect","EventManager","NewUtils","logger","ZyxAccountDialog","ZyxComTop","ZyxGame","ZyxGridCom","ZyxLineCom","ZyxMainScene","ZyxRewardItem"]);